# Chia Tien Project Guidelines

Welcome to the Chia Tien project. This document outlines the core engineering principles, architectural patterns, and coding standards adopted in this codebase. Always prioritize these rules when making changes.

## ğŸš€ React 19 First

We leverage the latest React 19 features to provide a superior user experience and cleaner developer experience (DX).

### 1. Form Actions & Hooks

- **Actions**: Always use `<form action={handleAction}>` for data mutations. Avoid manual `handleSubmit` functions with `e.preventDefault()`.
- **`useActionState`**: Use this hook to manage form state, pending status, and validation errors.
- **`useFormStatus`**: Submit buttons (like our `Button` atom) should leverage `useFormStatus` to automatically display loading spinners and handle disabled states during parent form submission.
- **`useOptimistic`**: Implement for high-interaction lists (like adding people) to provide instant UI feedback before the background sync completes.

### 2. Advanced Performance Patterns

- **`useEffectEvent`**: Use this to wrap event handlers inside `useEffect` to decouple non-reactive logic from effect reactivity. This prevents unnecessary re-attachments of listeners.
- **`Activity` (Offscreen)**: In multi-step modals or tabbed interfaces, use `<Activity mode="visible | hidden">` instead of conditional unmounting to preserve local component state and focus.
- **`useSyncExternalStore`**: Use for hydration-safe client-side checks (e.g., `isClient`) to avoid hydration mismatches in our SSR (TanStack Start) environment.

---

## ğŸ—ï¸ Modular Architecture

Maintain a strict modular folder structure for components. Every significant component or feature area should be self-contained.

### Component Folder Structure

Each component directory should typically include:

- `ComponentName.tsx`: The main component logic and JSX.
- `ComponentName.types.ts`: TypeScript interfaces and types.
- `ComponentName.hooks.ts`: Custom logic/state hooks for the component.
- `ComponentName.styles.ts`: For complex animations (Framer Motion variants) or specific CSS modules.
- `index.ts`: Clean export for the component.

### Sub-component Pattern

If a component grows too large, break it down into a `components/` sub-folder within its own directory:
`AdvancedServiceModal/`
â”œâ”€â”€ `AdvancedServiceModal.tsx`
â”œâ”€â”€ `components/`
â”‚ â”œâ”€â”€ `Step1ServiceInfo/`
â”‚ â”‚ â”œâ”€â”€ `Step1ServiceInfo.tsx`
â”‚ â”‚ â””â”€â”€ `index.ts`
â”‚ â””â”€â”€ ...

### Pages vs Routes

- **`src/routes/`**: Route files (TanStack Start/Router) should only define the route configuration (path, params, loaders) and render the main Page component. **Do not** write unrelated business logic or complex UI here.
- **`src/components/pages/`**: All page-level components live here.
  - **`src/components/pages/GroupDetail/`**: Contains all logic for Group Detail page.
  - **`src/components/pages/TopicDetail/`**: Contains all logic for Topic Detail page.
  - `src/components/pages/[PageName]/[PageName].tsx`: The main page entry point.
  - `src/components/pages/[PageName]/components/`: Page-specific sub-components.
- **`src/routes/`**: Thin wrappers only. Use `index.tsx` suffix (e.g., `_auth.groups.$groupId.index.tsx`) for leaf routes if they share path segments with other routes to avoid unintentional layout wrapping.

---

## ğŸ¨ UI & UX Standards

- **Neobrutalism Design**: Follow the established theme (bold borders, strong shadows, vibrant/pastel colors).
- **Framer Motion**: Use for all transitions. Transition state changes with `AnimatePresence` or layout animations where appropriate.
- **i18n**: All user-facing strings must use `useTranslation`. Do not hardcode Vietnamese or English text directly in JSX.
- **Type Safety**: No `any`. Explicitly type all props, state, and function return values.

---

## ğŸ› ï¸ Tooling & Tech Stack

- **Framework**: TanStack Start (SSR).
- **State**: `@tanstack/react-store`.
- **CSS**: Tailwind CSS 4.
- **Icons**: Google Material Symbols (Outlined).
